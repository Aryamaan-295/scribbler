<!DOCTYPE html>
<html lang="en" >
	<head>
		<!-- Meta data for SEO etc -->
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1">
		<link rel="icon"  href="images/logo2.png">
		<meta name="description" content="A notebook for experimenting in JavaScript. Experiment and play with html and javascript using simple interface (without servers and backend deployment). All the computation happens in your browser.">
		<script>global=globalThis</script>
		<title>JSNB: JavaScript Notebook</title>

		<!-- Styling using pico.css and some custome css -->
		<link rel="stylesheet" href="css/pico.min.css">
		<link rel="stylesheet" href="css/style.css">

		<!-- Codemirror for code box -->
		<script src="codemirror/codemirror.js"></script>
		<link rel="stylesheet" href="codemirror/codemirror.css">
		<script src="codemirror/javascript.js"></script> <!--For styling javascript code -->

		<!-- Controllers and libs -->
		<script src="js/libs.js"></script> <!-- libs for some functionality -->
		<script src="js/controller.js"></script> <!-- Controls the UI -->
		<script src="js/worker.js"></script> <!-- Runs the user generated code -->
		<script src="js/github.js"></script> <!-- Functions for pushing and pulling from/to Github -->
		<script src="js/modal.js"></script> <!-- Modal/popul handling -->
	</head>
  <body data-theme="light" >
	<nav> <!-- Menu bar -->
	  <ul>
	    <li><img src='images/logo2.png' id="logo"/></li>
	    <li><a id="nb_name" contentEditable="true">Untitled Notebook</a></li> <!-- Title of the notebook -->
	    <li role="list" dir="rtl">
	      <a  tabindex="0" aria-haspopup="listbox">File</a>
	      <ul role="listbox">
	        <li><a href="." target="_blank">New </a></li>
		<li><a onclick="load_file_click()">Open (Ctrl-O)</a><input style="display:none" type="file" id="upload_file"  /></li>
	        <li><a onclick="download_nb()">Download (Ctr-S)</a></li>
	        <li><a data-target="git-import-export" onClick="toggleModal(event)">GitHub (Gtr-G)</a></li>
	        <li><a onclick="download_html(false)">Download as HTML</a></li>
	        <li><a onclick="download_html(true)">Download only output</a></li>
	        <li><a onclick="download_js()">Download as JS</a></li>
	      </ul>
	    </li>
	    <li role="list" dir="rtl">
	      <a tabindex="0" aria-haspopup="listbox">Edit</a>
	      <ul role="listbox">
	        <li><a onclick="insert_cell('code')">Insert code cell</a></li>
	        <li><a onclick="insert_cell('html')">Insert html cell</a></li>
	      </ul>
	    </li>
	    <li role="list" dir="rtl">
	      <a tabindex="0" aria-haspopup="listbox">Help</a>
	      <ul role="listbox">
	        <li><a href='https://github.com/gopi-suvanam/jsnb/blob/main/DOCS.md' target='_blank'>Docs</a></li>
	        <li><a href="https://github.com/gopi-suvanam/jsnb/blob/main/examples/README.md" target='_blank'>Sample Notebooks</a></li>
	      </ul>
	    </li>
	  </ul>
	  <ul>
	  	<li>
	  	 <a><input  id="run_on_load" data-tooltip="Run the code when the file is loaded" type="checkbox" class="cell-type"  ></input> </a>
		</li>	
	    <li >
	      <a href="#" role="button" data-tooltip="Run all: Alt/Option-R" onclick="event.preventDefault();run_all()"  style="margin-right:5px">&#9658;</a>
	    </li>
	    <li>
	   	<a href="https://github.com/gopi-suvanam/jsnb/" role="button" >Github</a> 
	    </li>
	  </ul>
	</nav>
	<span id="top"></span>
	<!-- Template code block. This html will be copied and udpated for each cell -->
	<div id="code_block_template" style="display:none">
		<div  id="cell_menu_block_id" class="cell-menu">
			<a tabindex="0" data-tooltip="Toggle between code and html"> 
			<input  id="cell_type_block_id" style="height:15px;" type="checkbox" class="cell-type" checked="true" ></input>
			</a>
			<a tabindex="0" data-tooltip="Run the cell: Cmd/Ctrl-Enter"   onclick="run(_block_id)">&#9658;</a>
			<a tabindex="0" data-tooltip="Move the cell up: Alt-D + Up arrow"   onclick="move_up(_block_id)">&#8593;</a>
			<a tabindex="0" data-tooltip="Move the cell down: Alt-D + Down arrow"    onclick="move_down(_block_id)">&#8595;</a>
			<a tabindex="0" data-tooltip="Add a cell bellow: Alt/Option-Enter"  onclick="insert_cell('code',_block_id)">&#10011;</a>
			<a tabindex="0" data-tooltip="Delete the cell: Alt/Option-D"  onclick="delete_cell(_block_id)">&#9747;</a>
			
		</div>
		<div id="input_block_id" tabindex='0' onfocusout="unfocus_editor(_block_id)" class='code'></div>
		<article style="display:block" id="result_block_id" ondblclick="toggle_editor(_block_id)">
			<p class="status" id="status_block_id"></p>
			<div class="output" id="output_block_id"></div>
		</article>
	</div>
	
	<div style="width:98%" class='container' id='main'></div> <!-- All the cells go inside this div -->
	<hr style="margin-top:20px">
	
	<dialog id="git-import-export"> <!--Modal for Github export/import -->
	  <article>
	    <h5>Load your code from GitHub</h5>
	    <p>
	      Load a JSNB from public repositories on GitHub or private repositories where you have access. Will require access token. <a  target="_blank" href="https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token#creating-a-fine-grained-personal-access-token">How to get access token?</a>
	    </p>
	    <input type='text' onchange="update_owner()" id='token' placeholder='Access Token'></input>
	    <input type='text' onchange="update_repos()" id='user' placeholder='Owner'></input>
	    <input list='repos' id='repo' placeholder='Repo'></input><datalist id='repos'></datalist>
	    <input type='text' id='path' placeholder='Path'></input>

	      <a href="#" data-target="git-import-export" onClick="event.preventDefault();toggleModal(event)" role="button" class="secondary">Cancel</a>
	      <a href="#" tabindex="0"   onclick="event.preventDefault();upload_to_git()" role="button">Push to Git</a>
	      <a href="#" tabindex="0" onclick="event.preventDefault();load_from_git()" role="button">Load from Git</a>
	     <footer>
	     	<p>The app does not store the access token on any server. It is stored only on the local machine (browser) and used to send requests to GitHub API. <p>
	     </footer>
	  </article>
	</dialog>
	
	<footer style="padding:0px;text-align:center">
		<span style="margin:auto">Created with <span style="color:red">&hearts;</span> for JavaScript</span>
	</footer>	
  </body>
  <script>
  	insitialize_page(); <!-- Load the notebook or insert an empty cell -->
  </script>

  <!-- Loading some libraries for power experience -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.0/d3.min.js"></script>
  <script src="https://cdn.plot.ly/plotly-2.16.1.min.js"></script>
  <script src="/di-libs/build/di-libs.js"></script>
</html>
